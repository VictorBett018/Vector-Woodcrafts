{% extends 'base.html' %}
{% load static %}
{% block title %}Cart{% endblock %}
{% block content %}

<style>
    /* Your existing styles */
.cart-page-container {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin: 20px;
}
.cart-page-container1{
    display: none;
}

.cart-products {
    flex-grow: 1;
    margin-right: 20px;
    margin-top: 30px;
}

.cart-summary {
    margin-top: 20px;
    width: 250px;
    background-color: rgb(216, 216, 216);
    padding: 20px;
    border-radius: 3px;
}

.cart-summary p {
    text-align: start;
}

.cart-table {
    width: 100%;
    border-collapse: collapse;
}

.cart-table th,
.cart-table td {
    padding: 10px;
}

.cart-table th {
    text-align: left;
}

.cart-summary .summary-details {
    margin-bottom: 20px;
}

.cart-summary .checkout-btn {
    display: block;
    width: 100%;
    padding: 10px;
    background-color: #4caf50;
    color: #fff;
    border: none;
    cursor: pointer;
    border-radius: 5px;
    font-size: 16px;
}

.cart-summary .checkout-btn:hover {
    background-color: #45a049;
}

.cart-item img {
    width: 100px;
    height: auto;
}

.product-name {
    font-weight: bold;
}

.product-name a {
    text-decoration: none;
    color: #000;
}

.product-price {
    color: #007bff;
}

.quantity-input {
    width: 50px;
    text-align: center;
}

.action-icon {
    color: #007bff;
}

.actions button {
    background: none;
    border: none;
    font-size: 18px;
    cursor: pointer;
}

/* Responsive styles */
@media only screen and (max-width: 768px) {
    .cart-page-container1 {
        flex-direction: column;
        align-items: center;
        margin: 10px;
    }

    .cart-summary {
        margin-top: 10px;
        width: 100%;
    }

    .cart-products {
        margin-right: 0;
    }

    .cart-table {
        display: none; /* Hide the table on small screens */
    }

    .cart-item-container {
        display: flex;
        flex-direction: column;
    }

    .cart-item {
        display: flex;
        flex-direction: row;
        border: 1px solid #ddd;
        border-radius: 5px;
        margin-bottom: 20px;
        padding: 10px;
        background-color: #f9f9f9;
    }

    .cart-item img {
        width: 50%;
        height: auto;
        margin-bottom: 10px;
    }

    .cart-item .product-name {
        font-weight: bold;
        margin-bottom: 5px;
    }

    .cart-item .product-price,
    .cart-item .product-subtotal {
        color: #007bff;
        margin-bottom: 5px;
    }

    .cart-item .quantity-input {
        width: 30px;
        text-align: center;
        margin-bottom: 10px;
    }

    .cart-item .actions {
        display: flex;
        
    }
}

</style>

<main id="cart-list">
    <div class="cart-page-container">
        <div class="cart-products">
            <h2>You have {{totalcartitems}} item(s) in your Cart</h2>
            {% if totalcartitems %}
            
            <!-- Table layout for larger screens -->
            <table class="cart-table">
                <thead>
                    <tr>
                        <th>Image</th>
                        <th>Name</th>
                        <th>Price</th>
                        <th>Quantity</th>
                        <th>Subtotal</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                {% for product_id, item in cart_data.items %}
                <tbody>
                    <tr>
                        <td>
                            <div class="cart-item">
                                <img src="{{item.image}}" alt="Product Image">
                            </div>
                        </td>
                        <td>
                            <div class="product-name"><a href="{% url 'product_details' item.pid %}">{{item.title}}</a></div>
                        </td>
                        <td>
                            <div class="product-price">Ksh {{item.price}}</div>
                        </td>
                        <td>
                            <input type="number" class="quantity-input product-qty-{{product_id}}" value="{{item.qty}}" min="1">
                        </td>
                        <td>
                            <div class="product-subtotal">Ksh {% widthratio item.price 1 item.qty %}</div>
                        </td>
                        <td>
                            <div class="actions">
                                <button class="update-product" id="update-product" data-product="{{product_id}}">
                                    <i class="action-icon ri-refresh-line" title="Update"></i>
                                </button>
                                <button class="delete-product" id="delete-product" data-product="{{product_id}}">
                                    <i class="action-icon ri-delete-bin-line" title="Delete"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                </tbody>
                {% endfor %}
            </table>
            
            <!-- Vertical list layout for smaller screens -->
            <div class="cart-item-container1">
                {% for product_id, item in cart_data.items %}
                <div class="cart-item">
                    <div>
                    <img src="{{item.image}}" alt="Product Image">
                    </div>
                    <div style="display: flex;flex-direction: column;">
                    <div class="product-name"><a href="{% url 'product_details' item.pid %}">{{item.title}}</a></div>
                    <div class="product-price">Ksh {{item.price}}</div>
                    <label for="quantity-input">Qty</label>
                    <input type="number" class="quantity-input product-qty-{{product_id}}" value="{{item.qty}}" min="1">
                    <div class="product-subtotal">Subtotal: Ksh {% widthratio item.price 1 item.qty %}</div>
                    <div class="actions">
                        <button class="update-product" id="update-product" data-product="{{product_id}}">
                            <i class="action-icon ri-refresh-line" title="Update"></i>
                        </button>
                        <button class="delete-product" id="delete-product" data-product="{{product_id}}">
                            <i class="action-icon ri-delete-bin-line" title="Delete"></i>
                        </button>
                    </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
        <h2>Your cart is empty</h2>
        {% endif %}
        </div>
    <div class="cart-summary">
        <h2>Cart Summary</h2>
        <div class="summary-details">
            <p><strong>Sub Total:</strong> Ksh {{cart_total_amount|floatformat:2}}</p>
            <p><strong>Vat 16%:</strong> Ksh {{vat|floatformat:2}}</p>
            <hr>
            <br>
            <p><strong>Total:</strong> Ksh {{total|floatformat:2}}</p>
            <hr>
        </div>
        {% if totalcartitems %}
        {% if user.is_authenticated %}
    <a style="text-decoration: none;" href="{% url 'checkout' %}"><button class="checkout-btn">Proceed to Checkout</button></a>
{% else %}
    <a style="text-decoration: none;" href="{% url 'sign-in' %}"><button class="checkout-btn">Login to Proceed</button></a>
{% endif %}
        {% endif %}

    </div>
</div>   
</main>


  {% endblock %}