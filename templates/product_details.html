{% extends 'base.html' %}
{% load static %}
{% block content %}
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
    }

    .container {
        display: flex;
        justify-content: center;
        align-items: flex-start;
        padding: 20px;
    }

    .product-image {
        flex: 1;
        margin-bottom: 20px;
    }

    .product-image img {
        width: 100%;
        max-width: 400px;
        height: auto;
    }

    .small-images {
        display: flex;
        justify-content: flex-start;
        align-items: center;
        margin-bottom: 20px;
    }

    .small-image {
        width: 60px;
        height: 60px;
        margin-right: 10px;
        cursor: pointer;
    }

    .small-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border: 1px solid #ddd;
        border-radius: 5px;
    }

    .product-details {
        flex: 1;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 5px;
        margin-left: 20px;
    }

    .product-name {
        font-size: 24px;
        font-weight: bold;
        margin-bottom: 10px;
    }

    .product-price {
        font-size: 20px;
        color: #007bff;
        margin-bottom: 10px;
    }

    .add-to-cart {
        display: inline-block;
        background-color: #007bff;
        color: #fff;
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        text-decoration: none;
        margin-right: 10px;
    }

    .add-to-wishlist {
        display: inline-block;
        background-color: #28a745;
        color: #fff;
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        text-decoration: none;
    }

    .product-description {
        margin-top: 20px;
    }

    .reviews {
        margin-top: 20px;
    }

    .related-products {
        margin-top: 40px;
        text-align: center;
    }

    .related-product {
        display: inline-block;
        width: 200px;
        margin-right: 20px;
        text-align: left;
    }

    .related-product img {
        width: 100%;
        height: auto;
        border: 1px solid #ddd;
        border-radius: 5px;
    }

    .related-product-name {
        font-size: 18px;
        font-weight: bold;
        margin-top: 10px;
    }

    .related-product-price {
        font-size: 16px;
        color: #007bff;
        margin-top: 5px;
    }
</style>
</head>
<body>

<div class="container">
    <div class="product-image">
        <img src="{{product.image.url}}" alt="Product Image">
        <div class="small-images">
            {% for p in p_image %}
            <div class="small-image"><img src="{{p.images.url}}" alt="Small Image 1"></div>
            <!-- Add more small images as needed -->
            {% endfor %}
        </div>
    </div>
    <div class="product-details">
        <div class="product-name">{{product.title}}</div>
        <div class="">
            <span><h3>Description</h3> </span><br>
            <span>{{product.description|truncatechars:100}}</span>
        </div>
        <br>
        <div class="product-price">Ksh {{product.price}} </div>
        <div class="quantity">
            <span>QTY : </span>
            <input style="height: 25px; width: 50px;" type="number" name="qty" id="quantity_wanted" value="1" class="quantity-wanted-{{product.id}}">
        </div>
        <br>
        <input type="hidden" class="product-pid-{{product.id}}" value="{{product.pid}}">
        <input type="hidden" class="product-image-{{product.id}}" value="{{product.image.url}}" >
        <input type="hidden" class="product-id-{{product.id}}" value="{{product.id}}" >
        <input type="hidden" class="product-title-{{product.id}}" value="{{product.title}}" >
                                                                            
        <button id="add-to-cart-btn" class="add-to-cart add-to-cart-btn" data-index="{{product.id}}">Add to Cart</button>
        <button class="add-to-wishlist">Add to Wishlist</button>
        
                                                       
        </div>
    </div>


<section style="margin: 30px;" >
    <section style="display: flex;">
        <div id="description" class="product-description">
            <a href="#description"> <h2>Description</h2></a> 
              <p>{{product.description}}</p>
          </div>
          <div id="reviews" style="margin-left: 30px;" class="reviews">
              <a href="#reviews"><h2>Reviews</h2> </a>
              {% for r in reviews %}
              <div>
              <span class="spr-review-header-byline">
                  <strong> {{r.user.username}} </strong> -
                  <span>{{r.date|date:"D M, Y"}}</span>
              </span> 
              <br> 
              <div class="rating"> 
                  {% for s in r.rating|ljust:r.rating %}
                  <i class="fa fa-star text-warning" aria-hidden="true "></i>
                  {% endfor %}
              </div> 
              {{ r.review }}
              </div>
                <br>                                                     
              {% endfor %}
    </section>
                                                   
        <!-- Reviews section can be added here -->
        <div>
           <strong id="review-res" class="text-success"></strong>
        {% if make_review == True %}
      {% if request.user.is_authenticated %}
        <form method="post"  action="{% url 'ajax-add-review' product.pid %}" class="review-form review-hide-form" id="review-form">
          {% csrf_token %}
         <div>
            <div>
              {{review_form.review}}  
            </div>
        </div> 
        <br>
         <div>
            {{review_form.rating}}  
        </div>
        <br>
        <div class="submit">
            <input type="submit" name="addComment" id="submitComment" class=" btn-default" value="Submit Review">
        </div>
        </form>
          {% endif %}
        {% endif %} 
        </div>
        
</section>
<section>
 <div class="container">
    <h2>Related Products</h2>
    <br>

    {% for p in products %}
    <div class="product">
      <img src="{{p.image.url}}" alt="Product 1">
      <a href="{% url 'product_details' p.pid %}"><h2>{{ p.title }}</h2></a>
      <p class="description">{{p.description|truncatechars:50}}</p>
      <div class="price-container">
        <p class="previous-price">Ksh {{p.old_price}} </p>
      <p class="current-price">ksh {{p.price}} </p>
      </div>
      <button class="wishlist-btn"><i class="ri-heart-line"></i></button>
      <button class="cart-btn"><i class="ri-shopping-cart-2-fill"></i></button>
      <button class="view-btn"><i class="ri-eye-line"></i></button>
    </div>
    {% endfor %}
 </div>
  
</section>

</div>
{% endblock %} 